PROC GRIND_START(REAL START_POSITION,REAL END_POSITION,REAL WORK_HAND,REAL WORK_LEAD,REAL WORK_ZUIDU,REAL SPEED) DISPLOF

;START_POSITION:磨削起点
;END_POSITION:磨削终点
;WORK_HAND:右左旋
;WORK_LEAD:导程
;WORK_ZUIDU:锥度
;SPEED:磨削速度

DEF REAL ZUIDU_DISTANCE,ZUIDU_SPEED,GRIND_DISTANCE,FULL_ANG;

WHEN $A_DBB[2]==1 DO DELDTG(AXNAME(G_0));删除余程延时0.1s执行下面的
WHEN ($A_DBB[2]==1) AND ($A_DBB[19]==1) DO POS[AXNAME(G_0)]=0.2 FA[AXNAME(G_0)]=30;0.4秒后退0.2mm

GRIND_DISTANCE=END_POSITION-START_POSITION;磨削全长
ZUIDU_DISTANCE=GRIND_DISTANCE*WORK_ZUIDU/2*ORI_G0;锥度距离
ZUIDU_SPEED=ABS(ZUIDU_DISTANCE/(GRIND_DISTANCE/SPEED));磨锥度速度
FULL_ANG=-GRIND_DISTANCE/WORK_LEAD*360*WORK_HAND;总角度

FGROUP(AXNAME(G_1));以台面速度为基准
POS[AXNAME(G_0)]=ZUIDU_DISTANCE FA[AXNAME(G_0)]=ZUIDU_SPEED G91 AX[AXNAME(G_1)]=GRIND_DISTANCE AX[AXNAME(G_2)]=FULL_ANG F=SPEED;

RET;

