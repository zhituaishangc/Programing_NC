PROC SCREW_W SAVE DISPLON
;磨削主程序

S_PAR_INI;参数初始化子程序

DRESS_STA=$A_DBB[0];是否修整
IF DRESS_STA==1
    DRESSER
    WHEEL_POS_CURNT=WHEEL_POS_CURNT-DRESS_TIME_R*DRESS_DEEP_R-DRESS_TIME_F*DRESS_DEEP_F
    RET
ENDIF

OPERA_STA=$A_DBB[1];是否对刀
IF OPERA_STA==1
    TOOL_SET
    WHEEL_POS_CURNT=TOOL_SET_X
    RET
ENDIF

;使用界面参数还是DIY参数
IF TECH_MODEL==0;选择界面工艺
    TECH_TIME_DIY=0;DIY磨削次数
    IF TECH_TIME_R+TECH_TIME_MR+TECH_TIME_MF+TECH_TIME_F==0;工艺参数中设置的总磨削次数
        RET
    ENDIF
ELSE;选择DIY工艺
    TECH_NUMCURNT=4
    IF TECH_TIME_DIY==0
        RET
    ENDIF
ENDIF
;--------------------------------------------------------------------------
WHILE(TECH_TIME_RCURNT+TECH_TIME_MRCURNT+TECH_TIME_MFCURNT+TECH_TIME_FCURNT+TECH_TIME_DIYCURNT<=TECH_TIME_R+TECH_TIME_MR+TECH_TIME_MF+TECH_TIME_F+TECH_TIME_DIY)
    STOPRE
	S_CYCLE ;工件类型
	INI_ANGLE;初始角度计算
	S_BCYC;工序进给大循环判断
	S_LINESPEED_GRIND;磨削时砂轮速度调节子程序
ENDWHILE
;--------------------------------------------------------------------------
S_GRINDING_END
RET
